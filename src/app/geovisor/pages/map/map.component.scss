/*
 * :host es el selector para el propio componente <app-map>.
 * Lo configuramos para que ocupe toda la pantalla de una manera robusta
 * que funciona mejor que '100vh' en móviles.
*/
:host {
  display: block;
  width: 100%;
  height: 100%;
  overflow: hidden;
 position: relative;
}

.map-container {
  width: 100%;
  height: 100%;
  position: relative;
}

.map-view {
  width: 100%;
  height: 100%;
  position: absolute;

  inset: 0;
  /*
   * Mejora el rendimiento de los gestos en el mapa y evita
   * conflictos con los gestos del navegador (ej. pull-to-refresh).
  */
  touch-action: none;

  /*
   * Solución para el error de renderizado de "espejo" en algunas versiones de Chrome para Android.
   * - `direction: ltr` asegura la dirección de renderizado de izquierda a derecha.
   * - `transform: translateZ(0)` fuerza la aceleración por hardware (GPU), lo que
   *   a menudo resuelve bugs de renderizado en navegadores móviles.
   * - `backface-visibility: hidden` es otra técnica para forzar la composición en la GPU.
  */
  direction: ltr;
  -webkit-transform: translateZ(0);
  transform: translateZ(0);
  -webkit-backface-visibility: hidden;
  backface-visibility: hidden;
}

/*
 * Usamos ::ng-deep para aplicar estilos a los componentes hijos
 * desde el padre. Esto es necesario para ajustar su posición
 * respetando las áreas seguras del iPhone.
*/

::ng-deep {
  /* Ajusta la barra de navegación superior */
  app-navbar {
    width: 100%;
    position: relative;
    .navbar-container {
      // Añade padding superior para no quedar debajo del "notch" o la isla dinámica.
      width: 100%;
      overflow: hidden;
      padding-top: env(safe-area-inset-top, 1rem);
      position: fixed;
      top: 0;
    }
  }

  /* Ajusta el contenedor de botones flotantes */
  app-fab-container-top {
    .fab-container {
      // Mueve los botones hacia abajo para no chocar con el notch.
      top: env(safe-area-inset-top, 1rem);
    }
  }

  /* Ajusta el componente de información de coordenadas */
  app-info-coordenadas {
    .info-coordenadas-container {
      // Añade padding inferior para no quedar debajo de la barra de gestos.
      padding-bottom: env(safe-area-inset-bottom, 1rem);
    }
  }
}
